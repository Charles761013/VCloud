{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}Index{% endblock %}

{% block head %}
  <link rel="stylesheet" href="{% static "css/index.css" %}">
{% endblock %}

{% block body_block %}
  {% if video %}
    <h3>[Use VLC Plugin]</h3>
    <h3>{{ video.title }}</h3>
    <h5>觀看次數: {{ video.views }}</h5>
    <h5>{{ video.description }}</h5>
    <h5>上傳時間: <small>{{ video.upload_date }}</small></h5>
    <h5 id="like_count">{{ likes_number }}<h5>
      {% if isLike %}
        <button id="like" class="btn btn-primary btn-sm" type="button" video-id="{{ video.id }}" act-type="unlike">
          <span class="glyphicon glyphicon-thumbs-down"></span>UnLike
        </button>
      {% else %}
        <button id="like" class="btn btn-primary btn-sm" type="button" video-id="{{ video.id }}" act-type="like">
          <span class="glyphicon glyphicon-thumbs-up"></span>Like
        </button>
      {% endif %}
    <hr>
    <form role="form" id="review_form" method="post" action="{% url 'videoplay' %}">
    <h3 class="form-signin-heading">留言</h3>
        {% csrf_token %}
        <input type="hidden" name="video_id" value="{{video.id}}">
        {% for hidden in form.hidden_fields %}
            {{ hidden }}
        {% endfor %}

        {% for field in form.visible_fields %}
            {{ field.errors }}
            {{ field.help_text }}
            {{ field }}
        {% endfor %}
        <br/><br/>
        <button class="btn btn-info" type="submit" name="submit">新增留言</button>
    </form>
    <br/><br/>
    {% if reviews %}
      <ul class="list-group">
          {% for r in reviews %}
            <li class="list-group-item">
              <div>
                <h4><a href="{% url 'personal_videos' %}?user_id={{ r.user.id }}">{{ r.user }}</a></h4><br>
                <h5>{{ r.text }}</h5>
                {% if user.id == r.user.id %}
                <div id="message-{{ r.id }}"></div>
                <button class="btn btn-danger" type="submit" name="submit" style="font-size: 6px" id="delete-{{ r.id }}">刪除留言</button>
                <button class="btn btn-info" type="submit" name="submit" style="font-size: 6px" id="edit-{{ r.id }}">編輯留言</button>
                {% endif %}
              </div>
            </li>
          {% endfor %}
      </ul>
    {% else %}
      <h4>沒有評論</h4>
    {% endif %}
  {% else %}
    <h4>沒有影片</h4>
  {% endif %}

  <script src="{% static "js/videoplay-ajax.js" %}"></script>
{% endblock %}